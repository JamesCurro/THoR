{
    "contents" : "library(ggplot2)\nlibrary(dplyr)\nlibrary(plyr)\nlibrary(reshape2)\n\nthor = read.csv('THoRALL12to14.csv')\nthor$Rank = order(thor$WAR,decreasing=T)\n\n# Make ranking by position\nthor = ddply(thor,.(Position),transform,\n             PosRank = order(WAR,decreasing=T))\nthor$TeamInd = 'ZTeams'\nthor$TeamInd[thor$Team == 'BOSTON BRUINS'] = 'BOSTON BRUINS'\n\nggplot(thor, aes(x=WAR,y=PosRank)) + \n  geom_point(alpha = I(.6),size=I(3),aes(colour=TeamInd)) + \n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('WAR by position') +\n  scale_colour_brewer(palette = \"Set1\") +\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Make team data\nteamthor = ddply(thor,.(Team,Position),summarise,\n                 WAR = sum(WAR))\nteamthor = ddply(teamthor,.(Position),transform,\n                 PosRank = rank(-WAR,ties.method='min'))\n\n# Make divisions\natlantic = c('BOSTON BRUINS','BUFFALO SABRES','DETROIT RED WINGS','FLORIDA PANTHERS',\n\t'MONTREAL CANADIENS','OTTAWA SENATORS','TAMPA BAY LIGHTNING','TORONTO MAPLE LEAFS')\nmetro = c('CAROLINA HURRICANES','COLUMBUS BLUE JACKETS','NEW JERSEY DEVILS','NEW YORK ISLANDERS',\n\t'NEW YORK RANGERS','PHILADELPHIA FLYERS','PITTSBURGH PENGUINS','WASHINGTON CAPITALS')\ncentral = c('CHICAGO BLACKHAWKS','COLORADO AVALANCHE','DALLAS STARS','MINNESOTA WILD',\n\t'NASHVILLE PREDATORS','ST. LOUIS BLUES','WINNIPEG JETS')\npacific = c('ANAHEIM DUCKS','CALGARY FLAMES','EDMONTON OILERS','LOS ANGELES KINGS',\n\t'PHOENIX COYOTES','SAN JOSE SHARKS','VANCOUVER CANUCKS')\nteamthor$Division = 'Atlantic'\nteamthor$Division[teamthor$Team %in% metro] = 'Metro'\nteamthor$Division[teamthor$Team %in% central] = 'Central'\nteamthor$Division[teamthor$Team %in% pacific] = 'Pacific'\n\n# Make Division indicators\nteamthor$Atlantic = as.character(teamthor$Team)\nteamthor$Atlantic[teamthor$Division != 'Atlantic'] = 'Other'\n\nteamthor$Metro = as.character(teamthor$Team)\nteamthor$Metro[teamthor$Division != 'Metro'] = 'Other'\n\nteamthor$Central = as.character(teamthor$Team)\nteamthor$Central[teamthor$Division != 'Central'] = 'Other'\n\nteamthor$Pacific = as.character(teamthor$Team)\nteamthor$Pacific[teamthor$Division != 'Pacific'] = 'Other'\n\napply(teamthor, 2, function(x){if(x$Division) x$Atlantic = x$Team})\n\nteamthor$TeamInd = 'Other'\nteamthor$TeamInd[teamthor$Team == 'BOSTON BRUINS'] = 'BOSTON BRUINS'\nteamthor$TeamInd[teamthor$Team == 'CHICAGO BLACKHAWKS'] = 'CHICAGO BLACKHAWKS'\nteamthor$TeamInd[teamthor$Team == 'EDMONTON OILERS'] = 'EDMONTON OILERS'\nteamthor$TeamInd[teamthor$Team == 'SAN JOSE SHARKS'] = 'SAN JOSE SHARKS'\nteamthor$TeamInd[teamthor$Team == 'PITTSBURGH PENGUINS'] = 'PITTSBURGH PENGUINS'\nteamthor$TeamInd[teamthor$Team == 'TORONTO MAPLE LEAFS'] = 'TORONTO MAPLE LEAFS'\nteamthor$TeamInd[teamthor$Team == 'BUFFALO SABRES'] = 'BUFFALO SABRES'\n\n# Specific team rankings\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,colour=TeamInd)) + \n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('WAR by position') +\n  scale_colour_brewer(palette = \"Set1\") +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Conference rankings\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,colour=Division)) + \n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('THoR by position') +\n  scale_colour_brewer(palette = \"Set1\") +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Atlantic Conference\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,color=Atlantic)) + \n  scale_colour_manual(values = c('yellow','grey','red','orange','purple','black','brown','green','pink')) +\n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('THoR by position') +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Metro Conference\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,color=Metro)) + \n  scale_colour_manual(values = c('yellow','grey','red','orange','purple','black','brown','green','pink')) +\n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('THoR by position') +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Central Conference\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,color=Central)) + \n  scale_colour_manual(values = c('yellow','grey','red','orange','purple','black','brown','green')) +\n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('THoR by position') +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\n# Pacific Conference\nggplot(teamthor, aes(y=WAR,x=PosRank)) + \n  geom_point(aes(size=1.5,color=Pacific)) + \n  scale_colour_manual(values = c('yellow','grey','red','orange','black','purple','brown','green')) +\n  facet_wrap(~Position, ncol = 2) +\n  ggtitle('THoR by position') +\n  xlim(c(32,0))+\n  theme(plot.title = element_text(face=\"bold\", size=30, vjust = 2)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18)) +\n  theme(axis.text.y = element_text(size = 16))\n\nlibrary(dplyr)\nlibrary(plyr)\nlibrary(reshape2)\nheader = c('DayofWeek','MonthDay','Year','StartTime','EndTime','Rink','ID','GameofYear','AwayTeam','HomeTeam',\n           'Period','Strength','TimetoPeriod','Event','EventCount','Description','ForPlayer','TakePlayer',\n           'Assist1','Assist2','Location','ShotType','ShotLocation','Distance','AP1','AP2','AP3','AP4','AP5','AP6',\n           'HP1','HP2','HP3','HP4','HP5','HP6','xcoord','ycoord','ForInd','AwayNum','HomeNum','TurnInd')\n\nall = read.csv('AllStats.csv',header=F,\n               col.names=c(header,rep('V',20)))\ns = select(all,GameofYear,Period,Event,EventCount,ForPlayer,TakePlayer,Location,ShotType,AP1,AP2,AP3,AP4,AP5,AP6,HP1,HP2,HP3,HP4,HP5,HP6,\n                ForInd,TurnInd,AwayNum,HomeNum)  \nsmelt = melt(s, id=c('GameofYear','Period','Event', 'EventCount', 'ForPlayer', 'TakePlayer','Location', 'ShotType', \n                     'ForInd', 'TurnInd', 'AwayNum', 'HomeNum'))\ncolnames(smelt) = c('GameofYear','Period','Event', 'EventCount', 'ForPlayer', 'TakePlayer','Location', 'ShotType', \n                    'ForInd', 'TurnInd', 'AwayNum', 'HomeNum', 'Dummy', 'Player')\n\n# Change Event, ForInd to change what we are looking at\n# Some ideas I had would be to look at the number of events by location\neventsonice = ddply(smelt,.(Event,ForInd,Player),summarize,\n               count = length(Player))\nhead(eventsonice)\n# By looking at ForPlayer, we can see the events where the player did the action for example shots\n# The example I have below looks at each player and the number of shots they took by shottype\neventsaction = ddply(smelt[smelt$Event == 'SHOT',],.(ShotType,Player),summarize,\n                  count = length(Player))\nhead(eventsaction)\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1392173434598.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3475531686",
    "id" : "6B581027",
    "lastKnownWriteTime" : 1393040441,
    "path" : "~/Dropbox/Joe Stuff/THoR/THoR/THoR.R",
    "project_path" : "THoR.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}